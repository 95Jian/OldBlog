{"remainingRequest":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\finalProject3\\Blog\\blog-view\\src\\views\\moments\\Moments.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\finalProject3\\Blog\\blog-view\\src\\views\\moments\\Moments.vue","mtime":1724679300488},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1724725039690},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1724724440346}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoJaW1wb3J0IHtnZXRNb21lbnRMaXN0QnlQYWdlTnVtLCBsaWtlTW9tZW50fSBmcm9tICJAL2FwaS9tb21lbnQiOw0KDQoJZXhwb3J0IGRlZmF1bHQgew0KCQluYW1lOiAiTW9tZW50cyIsDQoJCWRhdGEoKSB7DQoJCQlyZXR1cm4gew0KCQkJCS8v55SobG9jYWxTdG9yYWdl5pys5Zyw5a2Y5YKo5bey54K56LWe55qE5Yqo5oCBaWTmlbDnu4QNCgkJCQlsaWtlTW9tZW50SWRzOiBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGlrZU1vbWVudElkcycpIHx8ICdbXScpLA0KCQkJCW1vbWVudExpc3Q6IFtdLA0KCQkJCXBhZ2VOdW06IDEsDQoJCQkJdG90YWxQYWdlOiAwDQoJCQl9DQoJCX0sDQoJCWNyZWF0ZWQoKSB7DQoJCQl0aGlzLmdldE1vbWVudExpc3QoKQ0KCQl9LA0KCQljb21wdXRlZDogew0KCQkJaXNMaWtlKCkgew0KCQkJCXJldHVybiBmdW5jdGlvbiAoaWQpIHsNCgkJCQkJcmV0dXJuIHRoaXMubGlrZU1vbWVudElkcy5pbmRleE9mKGlkKSA+IC0xDQoJCQkJfQ0KCQkJfQ0KCQl9LA0KCQl3YXRjaDogew0KCQkJbGlrZU1vbWVudElkcyhuZXdWYWx1ZSkgew0KCQkJCS8v5bCGbGlrZU1vbWVudElkc+acgOaWsOWAvOeahGpzb27mlbDmja7kv53lrZjliLBsb2NhbFN0b3JhZ2UNCgkJCQl3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xpa2VNb21lbnRJZHMnLCBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSkpDQoJCQl9DQoJCX0sDQoJCW1ldGhvZHM6IHsNCgkJCWdldE1vbWVudExpc3QoKSB7DQoJCQkJLy/lpoLmnpzmnInliJnlj5HpgIHljZrkuLvouqvku71Ub2tlbg0KCQkJCWNvbnN0IGFkbWluVG9rZW4gPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FkbWluVG9rZW4nKQ0KCQkJCWNvbnN0IHRva2VuID0gYWRtaW5Ub2tlbiA/IGFkbWluVG9rZW4gOiAnJw0KCQkJCWdldE1vbWVudExpc3RCeVBhZ2VOdW0odG9rZW4sIHRoaXMucGFnZU51bSkudGhlbihyZXMgPT4gew0KCQkJCQlpZiAocmVzLmNvZGUgPT09IDIwMCkgew0KCQkJCQkJdGhpcy5tb21lbnRMaXN0ID0gcmVzLmRhdGEubGlzdA0KCQkJCQkJdGhpcy50b3RhbFBhZ2UgPSByZXMuZGF0YS50b3RhbFBhZ2UNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXRoaXMubXNnRXJyb3IocmVzLm1zZykNCgkJCQkJfQ0KCQkJCX0pLmNhdGNoKCgpID0+IHsNCgkJCQkJdGhpcy5tc2dFcnJvcigi6K+35rGC5aSx6LSlIikNCgkJCQl9KQ0KCQkJfSwNCgkJCWhhbmRsZUN1cnJlbnRDaGFuZ2UobmV3UGFnZSkgew0KCQkJCXRoaXMuc2Nyb2xsVG9Ub3AoKQ0KCQkJCXRoaXMucGFnZU51bSA9IG5ld1BhZ2UNCgkJCQl0aGlzLmdldE1vbWVudExpc3QoKQ0KCQkJfSwNCgkJCWxpa2UoaWQpIHsNCgkJCQlpZiAodGhpcy5saWtlTW9tZW50SWRzLmluZGV4T2YoaWQpID4gLTEpIHsNCgkJCQkJdGhpcy4kbm90aWZ5KHsNCgkJCQkJCXRpdGxlOiAn5LiN5Y+v5Lul6YeN5aSN54K56LWe5ZOmJywNCgkJCQkJCXR5cGU6ICd3YXJuaW5nJw0KCQkJCQl9KQ0KCQkJCQlyZXR1cm4NCgkJCQl9DQoJCQkJbGlrZU1vbWVudChpZCkudGhlbihyZXMgPT4gew0KCQkJCQlpZiAocmVzLmNvZGUgPT09IDIwMCkgew0KCQkJCQkJdGhpcy4kbm90aWZ5KHsNCgkJCQkJCQl0aXRsZTogcmVzLm1zZywNCgkJCQkJCQl0eXBlOiAnc3VjY2VzcycNCgkJCQkJCX0pDQoJCQkJCQl0aGlzLmxpa2VNb21lbnRJZHMucHVzaChpZCkNCgkJCQkJCXRoaXMubW9tZW50TGlzdC5mb3JFYWNoKGl0ZW0gPT4gew0KCQkJCQkJCWlmIChpdGVtLmlkID09PSBpZCkgew0KCQkJCQkJCQlyZXR1cm4gaXRlbS5saWtlcysrDQoJCQkJCQkJfQ0KCQkJCQkJfSkNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXRoaXMuJG5vdGlmeSh7DQoJCQkJCQkJdGl0bGU6IHJlcy5tc2csDQoJCQkJCQkJdHlwZTogJ3dhcm5pbmcnDQoJCQkJCQl9KQ0KCQkJCQl9DQoJCQkJfSkuY2F0Y2goKCkgPT4gew0KCQkJCQl0aGlzLiRub3RpZnkoew0KCQkJCQkJdGl0bGU6ICflvILluLjplJnor68nLA0KCQkJCQkJdHlwZTogJ2Vycm9yJw0KCQkJCQl9KQ0KCQkJCX0pDQoJCQl9DQoJCX0NCgl9DQo="},{"version":3,"sources":["Moments.vue"],"names":[],"mappings":";AAkCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Moments.vue","sourceRoot":"src/views/moments","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"ui top attached segment\" style=\"text-align: center\">\r\n\t\t\t<h2 class=\"m-text-500\">我的动态</h2>\r\n\t\t</div>\r\n\t\t<div class=\"ui attached segment m-padding-bottom-large\">\r\n\t\t\t<div class=\"moments\">\r\n\t\t\t\t<div class=\"moment\" v-for=\"(moment,index) in momentList\" :key=\"index\">\r\n\t\t\t\t\t<div class=\"avatar\">\r\n\t\t\t\t\t\t<img :src=\"$store.state.introduction.avatar\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"ui card\">\r\n\t\t\t\t\t\t<div class=\"content m-top\">\r\n\t\t\t\t\t\t\t<span style=\"font-weight: 700\">{{ $store.state.introduction.name }}</span>\r\n\t\t\t\t\t\t\t<span class=\"right floated\">{{ moment.createTime | dateFromNow }}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"content typo\" :class=\"{'privacy':!moment.published}\" v-viewer v-html=\"moment.content\"></div>\r\n\t\t\t\t\t\t<div class=\"extra content\">\r\n\t\t\t\t\t\t\t<a class=\"left floated\" @click=\"like(moment.id)\">\r\n\t\t\t\t\t\t\t\t<i class=\"heart icon\" :class=\"isLike(moment.id)?'like-color':'outline'\"></i>{{ moment.likes }}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<el-pagination @current-change=\"handleCurrentChange\" :current-page=\"pageNum\" :page-count=\"totalPage\"\r\n\t\t\t               layout=\"prev, pager, next\" background hide-on-single-page class=\"pagination\">\r\n\t\t\t</el-pagination>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {getMomentListByPageNum, likeMoment} from \"@/api/moment\";\r\n\r\n\texport default {\r\n\t\tname: \"Moments\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t//用localStorage本地存储已点赞的动态id数组\r\n\t\t\t\tlikeMomentIds: JSON.parse(window.localStorage.getItem('likeMomentIds') || '[]'),\r\n\t\t\t\tmomentList: [],\r\n\t\t\t\tpageNum: 1,\r\n\t\t\t\ttotalPage: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.getMomentList()\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tisLike() {\r\n\t\t\t\treturn function (id) {\r\n\t\t\t\t\treturn this.likeMomentIds.indexOf(id) > -1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tlikeMomentIds(newValue) {\r\n\t\t\t\t//将likeMomentIds最新值的json数据保存到localStorage\r\n\t\t\t\twindow.localStorage.setItem('likeMomentIds', JSON.stringify(newValue))\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetMomentList() {\r\n\t\t\t\t//如果有则发送博主身份Token\r\n\t\t\t\tconst adminToken = window.localStorage.getItem('adminToken')\r\n\t\t\t\tconst token = adminToken ? adminToken : ''\r\n\t\t\t\tgetMomentListByPageNum(token, this.pageNum).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.momentList = res.data.list\r\n\t\t\t\t\t\tthis.totalPage = res.data.totalPage\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.msgError(res.msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.msgError(\"请求失败\")\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleCurrentChange(newPage) {\r\n\t\t\t\tthis.scrollToTop()\r\n\t\t\t\tthis.pageNum = newPage\r\n\t\t\t\tthis.getMomentList()\r\n\t\t\t},\r\n\t\t\tlike(id) {\r\n\t\t\t\tif (this.likeMomentIds.indexOf(id) > -1) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '不可以重复点赞哦',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlikeMoment(id).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.likeMomentIds.push(id)\r\n\t\t\t\t\t\tthis.momentList.forEach(item => {\r\n\t\t\t\t\t\t\tif (item.id === id) {\r\n\t\t\t\t\t\t\t\treturn item.likes++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '异常错误',\r\n\t\t\t\t\t\ttype: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.avatar {\r\n\t\tmargin-left: -62.5px;\r\n\t\tfloat: left !important;\r\n\t}\r\n\r\n\t.avatar img {\r\n\t\theight: 45px;\r\n\t\twidth: 45px;\r\n\t\tborder-radius: 500px;\r\n\t}\r\n\r\n\t.moments {\r\n\t\tmargin-left: 26px !important;\r\n\t\tpadding-left: 40px !important;\r\n\t\tborder-left: 1px solid #dee5e7 !important;\r\n\t}\r\n\r\n\t.moment {\r\n\t\tmargin-top: 30px;\r\n\t}\r\n\r\n\t.moment:first-child {\r\n\t\tmargin-top: 0 !important;\r\n\t}\r\n\r\n\t.card {\r\n\t\twidth: 100% !important;\r\n\t}\r\n\r\n\t.card:before {\r\n\t\tborder-width: 0 0 1px 1px !important;\r\n\t\ttransform: translateX(-50%) translateY(-50%) rotate(45deg) !important;\r\n\t\tbottom: auto !important;\r\n\t\tright: auto !important;\r\n\t\ttop: 22px !important;\r\n\t\tleft: 0 !important;\r\n\t\tposition: absolute !important;\r\n\t\tcontent: '' !important;\r\n\t\tbackground-image: none !important;\r\n\t\tz-index: 2 !important;\r\n\t\twidth: 12px !important;\r\n\t\theight: 12px !important;\r\n\t\ttransition: background .1s ease !important;\r\n\t\tbackground-color: inherit !important;\r\n\t\tborder-style: solid !important;\r\n\t\tborder-color: #d4d4d5 !important;\r\n\t}\r\n\r\n\t.content.m-top {\r\n\t\tpadding: 10px 14px !important;\r\n\t}\r\n\r\n\t.content .right.floated {\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.content.typo * {\r\n\t\tfont-size: 14px !important;\r\n\t}\r\n\r\n\t.extra.content {\r\n\t\tpadding: 5px 14px !important;\r\n\t}\r\n\r\n\t.extra.content a {\r\n\t\tcolor: rgba(0, 0, 0, 0.7) !important;\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.extra.content a:hover {\r\n\t\tcolor: red !important;\r\n\t}\r\n\r\n\t.extra.content .like-color {\r\n\t\tcolor: red !important;\r\n\t}\r\n\r\n\t.extra.content i {\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.pagination {\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 3em;\r\n\t}\r\n\r\n\t.privacy {\r\n\t\tbackground: repeating-linear-gradient(145deg, #f2f2f2, #f2f2f2 15px, #fff 0, #fff 30px) !important;\r\n\t}\r\n</style>"]}]}