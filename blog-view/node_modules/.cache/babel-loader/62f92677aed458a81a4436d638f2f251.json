{"remainingRequest":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\babel-loader\\lib\\index.js!D:\\finalProject3\\Blog\\blog-view\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\finalProject3\\Blog\\blog-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\finalProject3\\Blog\\blog-view\\src\\views\\moments\\Moments.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\finalProject3\\Blog\\blog-view\\src\\views\\moments\\Moments.vue","mtime":1724679300488},{"path":"D:\\finalProject3\\Blog\\blog-view\\babel.config.js","mtime":1724679300469},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1724724441697},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\babel-loader\\lib\\index.js","mtime":1724724441850},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1724724441697},{"path":"D:\\finalProject3\\Blog\\blog-view\\node_modules\\vue-loader\\lib\\index.js","mtime":1724724440346}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGdldE1vbWVudExpc3RCeVBhZ2VOdW0sIGxpa2VNb21lbnQgfSBmcm9tICJAL2FwaS9tb21lbnQiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIk1vbWVudHMiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvL+eUqGxvY2FsU3RvcmFnZeacrOWcsOWtmOWCqOW3sueCuei1nueahOWKqOaAgWlk5pWw57uECiAgICAgIGxpa2VNb21lbnRJZHM6IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsaWtlTW9tZW50SWRzJykgfHwgJ1tdJyksCiAgICAgIG1vbWVudExpc3Q6IFtdLAogICAgICBwYWdlTnVtOiAxLAogICAgICB0b3RhbFBhZ2U6IDAKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRNb21lbnRMaXN0KCk7CiAgfSwKICBjb21wdXRlZDogewogICAgaXNMaWtlKCkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubGlrZU1vbWVudElkcy5pbmRleE9mKGlkKSA+IC0xOwogICAgICB9OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGxpa2VNb21lbnRJZHMobmV3VmFsdWUpIHsKICAgICAgLy/lsIZsaWtlTW9tZW50SWRz5pyA5paw5YC855qEanNvbuaVsOaNruS/neWtmOWIsGxvY2FsU3RvcmFnZQogICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xpa2VNb21lbnRJZHMnLCBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSkpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TW9tZW50TGlzdCgpIHsKICAgICAgLy/lpoLmnpzmnInliJnlj5HpgIHljZrkuLvouqvku71Ub2tlbgogICAgICBjb25zdCBhZG1pblRva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhZG1pblRva2VuJyk7CiAgICAgIGNvbnN0IHRva2VuID0gYWRtaW5Ub2tlbiA/IGFkbWluVG9rZW4gOiAnJzsKICAgICAgZ2V0TW9tZW50TGlzdEJ5UGFnZU51bSh0b2tlbiwgdGhpcy5wYWdlTnVtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMubW9tZW50TGlzdCA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgICB0aGlzLnRvdGFsUGFnZSA9IHJlcy5kYXRhLnRvdGFsUGFnZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5tc2dFcnJvcihyZXMubXNnKTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLm1zZ0Vycm9yKCLor7fmsYLlpLHotKUiKTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZShuZXdQYWdlKSB7CiAgICAgIHRoaXMuc2Nyb2xsVG9Ub3AoKTsKICAgICAgdGhpcy5wYWdlTnVtID0gbmV3UGFnZTsKICAgICAgdGhpcy5nZXRNb21lbnRMaXN0KCk7CiAgICB9LAogICAgbGlrZShpZCkgewogICAgICBpZiAodGhpcy5saWtlTW9tZW50SWRzLmluZGV4T2YoaWQpID4gLTEpIHsKICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgdGl0bGU6ICfkuI3lj6/ku6Xph43lpI3ngrnotZ7lk6YnLAogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxpa2VNb21lbnQoaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgdGl0bGU6IHJlcy5tc2csCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmxpa2VNb21lbnRJZHMucHVzaChpZCk7CiAgICAgICAgICB0aGlzLm1vbWVudExpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09IGlkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubGlrZXMrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiByZXMubXNnLAogICAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICB0aXRsZTogJ+W8guW4uOmUmeivrycsCiAgICAgICAgICB0eXBlOiAnZXJyb3InCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["getMomentListByPageNum","likeMoment","name","data","likeMomentIds","JSON","parse","window","localStorage","getItem","momentList","pageNum","totalPage","created","getMomentList","computed","isLike","id","indexOf","watch","newValue","setItem","stringify","methods","adminToken","token","then","res","code","list","msgError","msg","catch","handleCurrentChange","newPage","scrollToTop","like","$notify","title","type","push","forEach","item","likes"],"sources":["src/views/moments/Moments.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"ui top attached segment\" style=\"text-align: center\">\r\n\t\t\t<h2 class=\"m-text-500\">我的动态</h2>\r\n\t\t</div>\r\n\t\t<div class=\"ui attached segment m-padding-bottom-large\">\r\n\t\t\t<div class=\"moments\">\r\n\t\t\t\t<div class=\"moment\" v-for=\"(moment,index) in momentList\" :key=\"index\">\r\n\t\t\t\t\t<div class=\"avatar\">\r\n\t\t\t\t\t\t<img :src=\"$store.state.introduction.avatar\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"ui card\">\r\n\t\t\t\t\t\t<div class=\"content m-top\">\r\n\t\t\t\t\t\t\t<span style=\"font-weight: 700\">{{ $store.state.introduction.name }}</span>\r\n\t\t\t\t\t\t\t<span class=\"right floated\">{{ moment.createTime | dateFromNow }}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"content typo\" :class=\"{'privacy':!moment.published}\" v-viewer v-html=\"moment.content\"></div>\r\n\t\t\t\t\t\t<div class=\"extra content\">\r\n\t\t\t\t\t\t\t<a class=\"left floated\" @click=\"like(moment.id)\">\r\n\t\t\t\t\t\t\t\t<i class=\"heart icon\" :class=\"isLike(moment.id)?'like-color':'outline'\"></i>{{ moment.likes }}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<el-pagination @current-change=\"handleCurrentChange\" :current-page=\"pageNum\" :page-count=\"totalPage\"\r\n\t\t\t               layout=\"prev, pager, next\" background hide-on-single-page class=\"pagination\">\r\n\t\t\t</el-pagination>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {getMomentListByPageNum, likeMoment} from \"@/api/moment\";\r\n\r\n\texport default {\r\n\t\tname: \"Moments\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t//用localStorage本地存储已点赞的动态id数组\r\n\t\t\t\tlikeMomentIds: JSON.parse(window.localStorage.getItem('likeMomentIds') || '[]'),\r\n\t\t\t\tmomentList: [],\r\n\t\t\t\tpageNum: 1,\r\n\t\t\t\ttotalPage: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.getMomentList()\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tisLike() {\r\n\t\t\t\treturn function (id) {\r\n\t\t\t\t\treturn this.likeMomentIds.indexOf(id) > -1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tlikeMomentIds(newValue) {\r\n\t\t\t\t//将likeMomentIds最新值的json数据保存到localStorage\r\n\t\t\t\twindow.localStorage.setItem('likeMomentIds', JSON.stringify(newValue))\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetMomentList() {\r\n\t\t\t\t//如果有则发送博主身份Token\r\n\t\t\t\tconst adminToken = window.localStorage.getItem('adminToken')\r\n\t\t\t\tconst token = adminToken ? adminToken : ''\r\n\t\t\t\tgetMomentListByPageNum(token, this.pageNum).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.momentList = res.data.list\r\n\t\t\t\t\t\tthis.totalPage = res.data.totalPage\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.msgError(res.msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.msgError(\"请求失败\")\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleCurrentChange(newPage) {\r\n\t\t\t\tthis.scrollToTop()\r\n\t\t\t\tthis.pageNum = newPage\r\n\t\t\t\tthis.getMomentList()\r\n\t\t\t},\r\n\t\t\tlike(id) {\r\n\t\t\t\tif (this.likeMomentIds.indexOf(id) > -1) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '不可以重复点赞哦',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlikeMoment(id).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.likeMomentIds.push(id)\r\n\t\t\t\t\t\tthis.momentList.forEach(item => {\r\n\t\t\t\t\t\t\tif (item.id === id) {\r\n\t\t\t\t\t\t\t\treturn item.likes++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '异常错误',\r\n\t\t\t\t\t\ttype: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.avatar {\r\n\t\tmargin-left: -62.5px;\r\n\t\tfloat: left !important;\r\n\t}\r\n\r\n\t.avatar img {\r\n\t\theight: 45px;\r\n\t\twidth: 45px;\r\n\t\tborder-radius: 500px;\r\n\t}\r\n\r\n\t.moments {\r\n\t\tmargin-left: 26px !important;\r\n\t\tpadding-left: 40px !important;\r\n\t\tborder-left: 1px solid #dee5e7 !important;\r\n\t}\r\n\r\n\t.moment {\r\n\t\tmargin-top: 30px;\r\n\t}\r\n\r\n\t.moment:first-child {\r\n\t\tmargin-top: 0 !important;\r\n\t}\r\n\r\n\t.card {\r\n\t\twidth: 100% !important;\r\n\t}\r\n\r\n\t.card:before {\r\n\t\tborder-width: 0 0 1px 1px !important;\r\n\t\ttransform: translateX(-50%) translateY(-50%) rotate(45deg) !important;\r\n\t\tbottom: auto !important;\r\n\t\tright: auto !important;\r\n\t\ttop: 22px !important;\r\n\t\tleft: 0 !important;\r\n\t\tposition: absolute !important;\r\n\t\tcontent: '' !important;\r\n\t\tbackground-image: none !important;\r\n\t\tz-index: 2 !important;\r\n\t\twidth: 12px !important;\r\n\t\theight: 12px !important;\r\n\t\ttransition: background .1s ease !important;\r\n\t\tbackground-color: inherit !important;\r\n\t\tborder-style: solid !important;\r\n\t\tborder-color: #d4d4d5 !important;\r\n\t}\r\n\r\n\t.content.m-top {\r\n\t\tpadding: 10px 14px !important;\r\n\t}\r\n\r\n\t.content .right.floated {\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.content.typo * {\r\n\t\tfont-size: 14px !important;\r\n\t}\r\n\r\n\t.extra.content {\r\n\t\tpadding: 5px 14px !important;\r\n\t}\r\n\r\n\t.extra.content a {\r\n\t\tcolor: rgba(0, 0, 0, 0.7) !important;\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.extra.content a:hover {\r\n\t\tcolor: red !important;\r\n\t}\r\n\r\n\t.extra.content .like-color {\r\n\t\tcolor: red !important;\r\n\t}\r\n\r\n\t.extra.content i {\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\r\n\t.pagination {\r\n\t\ttext-align: center;\r\n\t\tmargin-top: 3em;\r\n\t}\r\n\r\n\t.privacy {\r\n\t\tbackground: repeating-linear-gradient(145deg, #f2f2f2, #f2f2f2 15px, #fff 0, #fff 30px) !important;\r\n\t}\r\n</style>"],"mappings":";AAkCA,SAAAA,sBAAA,EAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACA;MACAC,aAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,MAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,UAAA;MACAC,OAAA;MACAC,SAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,aAAA;EACA;EACAC,QAAA;IACAC,OAAA;MACA,iBAAAC,EAAA;QACA,YAAAb,aAAA,CAAAc,OAAA,CAAAD,EAAA;MACA;IACA;EACA;EACAE,KAAA;IACAf,cAAAgB,QAAA;MACA;MACAb,MAAA,CAAAC,YAAA,CAAAa,OAAA,kBAAAhB,IAAA,CAAAiB,SAAA,CAAAF,QAAA;IACA;EACA;EACAG,OAAA;IACAT,cAAA;MACA;MACA,MAAAU,UAAA,GAAAjB,MAAA,CAAAC,YAAA,CAAAC,OAAA;MACA,MAAAgB,KAAA,GAAAD,UAAA,GAAAA,UAAA;MACAxB,sBAAA,CAAAyB,KAAA,OAAAd,OAAA,EAAAe,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAlB,UAAA,GAAAiB,GAAA,CAAAxB,IAAA,CAAA0B,IAAA;UACA,KAAAjB,SAAA,GAAAe,GAAA,CAAAxB,IAAA,CAAAS,SAAA;QACA;UACA,KAAAkB,QAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA,GAAAC,KAAA;QACA,KAAAF,QAAA;MACA;IACA;IACAG,oBAAAC,OAAA;MACA,KAAAC,WAAA;MACA,KAAAxB,OAAA,GAAAuB,OAAA;MACA,KAAApB,aAAA;IACA;IACAsB,KAAAnB,EAAA;MACA,SAAAb,aAAA,CAAAc,OAAA,CAAAD,EAAA;QACA,KAAAoB,OAAA;UACAC,KAAA;UACAC,IAAA;QACA;QACA;MACA;MACAtC,UAAA,CAAAgB,EAAA,EAAAS,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAS,OAAA;YACAC,KAAA,EAAAX,GAAA,CAAAI,GAAA;YACAQ,IAAA;UACA;UACA,KAAAnC,aAAA,CAAAoC,IAAA,CAAAvB,EAAA;UACA,KAAAP,UAAA,CAAA+B,OAAA,CAAAC,IAAA;YACA,IAAAA,IAAA,CAAAzB,EAAA,KAAAA,EAAA;cACA,OAAAyB,IAAA,CAAAC,KAAA;YACA;UACA;QACA;UACA,KAAAN,OAAA;YACAC,KAAA,EAAAX,GAAA,CAAAI,GAAA;YACAQ,IAAA;UACA;QACA;MACA,GAAAP,KAAA;QACA,KAAAK,OAAA;UACAC,KAAA;UACAC,IAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]}]}